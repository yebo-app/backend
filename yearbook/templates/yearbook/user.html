{% extends 'yearbook/base.html' %}

{% block pagetitle %}
	{{ page_title }}
{% endblock %}

{% block content %}
	<h1>{{ yearbook_user.user.first_name }} {{ yearbook_user.user.last_name }}</h1>
	<img class="round profile-pic" src="{{ yearbook_user.avatar.url }}" height=80 width=80>
	<p>Bio: {{ yearbook_user.bio }}</p>




	<!-- Button to launch Add Education modal -->
	{% if user.yearbookuser == yearbook_user %}
	<button type="button" class="btn btn-primary mr-1 mb-1 waves-effect waves-light" data-toggle="modal" data-target="#default">
		Add Education 
	</button>
	<a class="btn btn-primary mr-1 mb-1 waves-effect waves-light" href="{% url 'settings' yearbook_user.id %}">Account Settings</a>
	<button type="button" class="btn btn-primary mr-1 mb-1 waves-effect waves-light" data-toggle="modal" data-target="#invite">
		Invite Friend
	</button>
	{% endif %}


	<!-- Add Education Modal -->
	<div class="modal fade text-left" id="default" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" style="display: none;" aria-hidden="true">
		<div class="modal-dialog modal-dialog-scrollable" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title" id="myModalLabel1">Add Education</h4>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<div class= "content-section">
						{% if not user.is_authenticated %}
							<p>Log in to update your yearbook profile.</p>
						{% elif user != yearbook_user.user %}
							<p>You are not authorized to edit this yearbook profile.</p>
						{% else %}
							<form method="POST">
								{% csrf_token %}
								<fieldset class="form-group">
									{{ register_form.as_p}}
								</fieldset>
								<div class="form-group">
									<button class="btn btn-outline-info" type="submit">Register</button>
								</div>
							</form>
						{% endif %}
					</div>
				</div>
				
			</div>
		</div>
	</div>

	<!-- Invite Friend Modal -->
	<div class="modal fade text-left" id="invite" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" style="display: none;" aria-hidden="true">
		<div class="modal-dialog modal-dialog-scrollable" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title" id="myModalLabel1">Invite a Friend</h4>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<div class= "content-section">
						{% if not user.is_authenticated or user != yearbook_user.user%}
							<p>Log in to invite a friend.</p>
						{% else %}
							<p>Add a friend's email to invite them to yebo. They can register and will also receive a link to your profile!</p>
							<form method="POST">
								{% csrf_token %}
								<fieldset class="form-group">
									Email:
									{{ invite_friend_form.friend_email }}
								</fieldset>
								<div class="form-group">
									<button class="btn btn-outline-info" type="submit">Invite</button>
								</div>
							</form>
						{% endif %}
					</div>
				</div>
				
			</div>
		</div>
	</div>

	<!-- Education History... List of IYPs -->
	<h1>Education History:</h1>
	{% if not history %}
		<p>This user has not joined any schools.</p>
	{% else %}
		{% for institution, iyps in history.items %}
			<ul>
			<li><a href="{% url 'institution' institution.id %}">{{ institution }}</a></li>
			<ul>
			{% for iyp in iyps %}
				<li><a href="{% url 'institutionyearprofile' iyp.id %}">{{ iyp.institution_year.school_year }}</a></li>
			{% endfor %}
			</ul>
			</ul>
		{% endfor %}
	{% endif %}
{% endblock %}
